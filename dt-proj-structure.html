<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>4 Project Structure | Data Team Handbook</title>
<meta name="author" content="Global TIES for Children Data Team">
<meta name="description" content="#dt-proj-structure pre code {  font-size: 0.8rem; } The Data Team uses a variety of technologies, mainly in the R ecosystem, to create its data projects. Each project has a similar file structure...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="4 Project Structure | Data Team Handbook">
<meta property="og:type" content="book">
<meta property="og:url" content="https://r4ds.had.co.nz/dt-proj-structure.html">
<meta property="og:description" content="#dt-proj-structure pre code {  font-size: 0.8rem; } The Data Team uses a variety of technologies, mainly in the R ecosystem, to create its data projects. Each project has a similar file structure...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="4 Project Structure | Data Team Handbook">
<meta name="twitter:site" content="@NYUGlobalTIES">
<meta name="twitter:description" content="#dt-proj-structure pre code {  font-size: 0.8rem; } The Data Team uses a variety of technologies, mainly in the R ecosystem, to create its data projects. Each project has a similar file structure...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Team Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li class="book-part">Team</li>
<li><a class="" href="dt-purpose.html"><span class="header-section-number">1</span> Data Team Purpose</a></li>
<li><a class="" href="dt-structure.html"><span class="header-section-number">2</span> Data Team Structure</a></li>
<li><a class="" href="dt-workflow.html"><span class="header-section-number">3</span> How the Data Team schedules work</a></li>
<li class="book-part">Guides</li>
<li><a class="active" href="dt-proj-structure.html"><span class="header-section-number">4</span> Project Structure</a></li>
<li><a class="" href="styling-r.html"><span class="header-section-number">5</span> R Style Guide</a></li>
<li class="book-part">Curation</li>
<li><a class="" href="dataset-curation-standards.html"><span class="header-section-number">6</span> Dataset Curation Standards</a></li>
<li><a class="" href="active-curation.html"><span class="header-section-number">7</span> Active Curation</a></li>
<li><a class="" href="diversity-equity-inclusion-and-accessibility-in-data.html"><span class="header-section-number">8</span> Diversity, Equity, Inclusion and Accessibility in Data</a></li>
<li><a class="" href="dataset-restrictions-and-embargos.html"><span class="header-section-number">9</span> Dataset Restrictions and Embargos</a></li>
<li><a class="" href="data-management-plan-templates.html"><span class="header-section-number">10</span> Data Management Plan Templates</a></li>
<li><a class="" href="spreadsheet-standards-and-practices.html"><span class="header-section-number">11</span> Spreadsheet standards and practices</a></li>
<li><a class="" href="citation-formats.html"><span class="header-section-number">12</span> Citation formats</a></li>
<li><a class="" href="other-data-team-services.html"><span class="header-section-number">13</span> Other Data Team Services</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="glossary.html">Glossary</a></li>
<li><a class="" href="resources-1.html">Resources</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/nyuglobalties/dt-handbook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="dt-proj-structure" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Project Structure<a class="anchor" aria-label="anchor" href="#dt-proj-structure"><i class="fas fa-link"></i></a>
</h1>
<style type="text/css">
#dt-proj-structure pre code {
  font-size: 0.8rem;
}
</style>
<p>The Data Team uses a variety of technologies, mainly in the R ecosystem, to create its data projects. Each project has a similar file structure to maintain consistency and replicability across projects:</p>
<pre><code>.github/         # All Github configuration [optional]
  workflows/     # All CI workflow definition files [optional]
blueprints/      # Contains all "blueprints" of datasets
codebooks/       # Contains exported codebooks of select datasets, depending on blueprint definition
config/
  environment.R  # Definitions of all environment variables used in this project
  packages.R     # Any `library()` for packages to be available across the project
R/               # All definitions for custom functions employed in the pipeline
.Rprofile        # Supplemental file that primarily sets up `renv`
_targets.R       # The main workflow orchestration definition file
renv.lock        # Package dependency state capture file for `renv`</code></pre>
<p>What’s important note from the outset is that <strong>data are not inside in these projects</strong>. Each project is versioned with <a href="https://git-scm.org">git</a> and hosted on <a href="https://github.com/nyuglobalties">TIES’ GitHub organization page</a>. Most of our data are sensitive to some degree, so our operational practice is to load data directly via APIs or read from <a href="https://nyu.app.box.com">NYU Box</a>.</p>
<p>Project templates can be created with the internal tool <a href="https://github.com/nyuglobalties/dtproj">dtproj</a>.</p>
<div id="blueprints" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> <code>blueprints</code><a class="anchor" aria-label="anchor" href="#blueprints"><i class="fas fa-link"></i></a>
</h2>
<p>The Data Team uses its <a href="https://nyuglobalties.github.io/blueprintr"><code>blueprintr</code></a> package to build, test, and document datasets. <code>blueprintr</code> is akin to <a href="https://getdbt.com">dbt</a>, but it is designed to manage a whole host of metadata, a necessary task for dissemination of project findings and data publication. Moreover, <code>blueprintr</code> operates without a connection to a data warehouse, given the assumptions of low connectivity and technical availability that the Data Team operates in.</p>
<p>Each <strong>blueprint</strong> is a pair of two files:</p>
<ol style="list-style-type: decimal">
<li>
<strong>The blueprint definition file</strong>: an R script with a single <code>blueprint()</code> command. This file details how to generate the desired dataset and optionally includes arbitrary metadata at dataset/table level.</li>
<li>
<strong>The blueprint metadata file</strong>: a CSV file with, at minimum, the columns <code>name</code>, <code>type</code>, and <code>description</code>. This file enumerates the variable-level metadata.</li>
</ol>
<p>Here is an example blueprint definition file:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">blueprint</span><span class="op">(</span>
  <span class="st">"ch_scales"</span>,
  description <span class="op">=</span> <span class="st">"Self-Regulation &amp; Self-Regulated Learning"</span>,
  command <span class="op">=</span>
    <span class="fu">.TARGET</span><span class="op">(</span><span class="st">"verified_child_data"</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">select</span><span class="op">(</span>
        <span class="va">unique_id</span>,
        <span class="va">c_id_01</span>,
        <span class="fu">starts_with</span><span class="op">(</span><span class="st">"c_sr_"</span><span class="op">)</span>,
        <span class="fu">starts_with</span><span class="op">(</span><span class="st">"c_srl_"</span><span class="op">)</span>
      <span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">shorten_domain_prefixes</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">enumerator_regulation_score</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">basic_number_renaming</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">drop_underscore_in_vars</span><span class="op">(</span>
        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sr"</span>, <span class="st">"srl"</span><span class="op">)</span>,
        <span class="st">"^.*{var}_(\\d+)r?$"</span>
      <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>And here is an example metadata CSV for the same blueprint:</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
type
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
title
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
description
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
coding
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
tests
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
scale
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
section
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
unique_id
</td>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
Survey submission ID
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
IDs
</td>
</tr>
<tr>
<td style="text-align:left;">
cid_1
</td>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
Child ID
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
has_no_duplicates()
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
IDs
</td>
</tr>
<tr>
<td style="text-align:left;">
csr4
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csr4
</td>
<td style="text-align:left;">
Some kids find it easy to sit still when they are bored
BUT
Other kids find it hard to sit still when they are bored
Are you more like the kids that find it easy or hard?
</td>
<td style="text-align:left;">
coding(code(““Really easy”“, 3), code(”“Kind of easy”“, 2), code(”“Kind of hard”“, 1), code(”“Really hard”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
</tr>
<tr>
<td style="text-align:left;">
csr5
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csr5
</td>
<td style="text-align:left;">
Some kids find it easy to remember what they are supposed to do
BUT
Other kids find it hard to remember what they are supposed to do
Are you more like the kids that find it easy or hard?
</td>
<td style="text-align:left;">
coding(code(““Really easy”“, 3), code(”“Kind of easy”“, 2), code(”“Kind of hard”“, 1), code(”“Really hard”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
</tr>
<tr>
<td style="text-align:left;">
csr8
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csr8
</td>
<td style="text-align:left;">
Some kids find it easy to obey rules
BUT
Other kids find it hard to obey rules
Are you more like the kids that find it easy or hard?
</td>
<td style="text-align:left;">
coding(code(““Really easy”“, 3), code(”“Kind of easy”“, 2), code(”“Kind of hard”“, 1), code(”“Really hard”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
</tr>
<tr>
<td style="text-align:left;">
csr10
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csr10
</td>
<td style="text-align:left;">
Some kids find it easy to be careful
BUT
Other kids find it hard to be careful
Are you more like the kids that find it easy or hard?
</td>
<td style="text-align:left;">
coding(code(““Really easy”“, 3), code(”“Kind of easy”“, 2), code(”“Kind of hard”“, 1), code(”“Really hard”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
</tr>
<tr>
<td style="text-align:left;">
csr12
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csr12
</td>
<td style="text-align:left;">
Some kids find it easy to think before they act
BUT
Other kids find it hard to think before they act
Are you more like the kids that find it easy or hard?
</td>
<td style="text-align:left;">
coding(code(““Really easy”“, 3), code(”“Kind of easy”“, 2), code(”“Kind of hard”“, 1), code(”“Really hard”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
</tr>
<tr>
<td style="text-align:left;">
csr13
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csr13
</td>
<td style="text-align:left;">
Some kids find it easy to pay attention to their schoolwork
BUT
Other kids find it hard to pay attention to their schoolwork
Are you more like the kids that find it easy or hard?
</td>
<td style="text-align:left;">
coding(code(““Really easy”“, 3), code(”“Kind of easy”“, 2), code(”“Kind of hard”“, 1), code(”“Really hard”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
</tr>
<tr>
<td style="text-align:left;">
csr15
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csr15
</td>
<td style="text-align:left;">
Some kids find it easy to focus on things that are important
BUT
Other kids find it hard to focus on things that are important
Are you more like the kids that find it easy or hard?
</td>
<td style="text-align:left;">
coding(code(““Really easy”“, 3), code(”“Kind of easy”“, 2), code(”“Kind of hard”“, 1), code(”“Really hard”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
</tr>
<tr>
<td style="text-align:left;">
csr16
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csr16
</td>
<td style="text-align:left;">
Some kids find it easy to work on a project until they are finished
BUT
Other kids find it hard to work on a project until they are finished
Are you more like the kids that find it easy or hard?
</td>
<td style="text-align:left;">
coding(code(““Really easy”“, 3), code(”“Kind of easy”“, 2), code(”“Kind of hard”“, 1), code(”“Really hard”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
</tr>
<tr>
<td style="text-align:left;">
csr17
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csr17
</td>
<td style="text-align:left;">
Some kids find it easy to concentrate on one thing for a long time
BUT
Other kids find it hard to concentrate on one thing for a long time
Are you more like the kids that find it easy or hard?
</td>
<td style="text-align:left;">
coding(code(““Really easy”“, 3), code(”“Kind of easy”“, 2), code(”“Kind of hard”“, 1), code(”“Really hard”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
</tr>
<tr>
<td style="text-align:left;">
csr18
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csr18
</td>
<td style="text-align:left;">
Some kids find it easy to stay focused on their goals
BUT
Other kids find it hard to stay focused on their goals
Are you more like the kids that find it easy or hard?
</td>
<td style="text-align:left;">
coding(code(““Really easy”“, 3), code(”“Kind of easy”“, 2), code(”“Kind of hard”“, 1), code(”“Really hard”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
<td style="text-align:left;">
Child Self-Regulation
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl1
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl1
</td>
<td style="text-align:left;">
Some kids make sure no one disturbs them when they study at home. Would you say you are like them? [pause for response].
Now that you decided that you [ARE/ARE NOT] like them. [If Yes] Are you ““A lot”” or ““Kind of”” like them? [If No] Are you ““A little”” or ““Not at all”” like them? [pause for response]
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl3
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl3
</td>
<td style="text-align:left;">
Some kids try to find a quiet place to study at home. Would you say you are like them? [pause for response].
Now that you decided that you [ARE/ARE NOT] like them. [If Yes] Are you ““A lot”” or ““Kind of”” like them? [If No] Are you ““A little”” or ““Not at all”” like them? [pause for response]
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl4
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl4
</td>
<td style="text-align:left;">
Some kids ask their friends or family for help when they are struggling with their homework. Would you say you are like them? [pause for response].
Now that you decided that you [ARE/ARE NOT] like them. [If Yes] Are you ““A lot”” or ““Kind of”” like them? [If No] Are you ““A little”” or ““Not at all”” like them? [pause for response]
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl10
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl10
</td>
<td style="text-align:left;">
Some kids encourage themselves or tell themselves ““you can do it”” when they are struggling with their homework. Would you say you are like them? [pause for response].
Now that you decided that you [ARE/ARE NOT] like them. [If Yes] Are you ““A lot”” or ““Kind of”” like them? [If No] Are you ““A little”” or ““Not at all”” like them? [pause for response]
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl15
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl15
</td>
<td style="text-align:left;">
Some kids review the instructions before starting their homework. Would you say you are like them?
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl16
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl16
</td>
<td style="text-align:left;">
Some kids try to calm down or take a deep breath when they are struggling with their homework. Would you say you are like them?
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl17
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl17
</td>
<td style="text-align:left;">
Some kids try to ““take their time”” and do their homework with patience. Would you say you are like them?
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl18
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl18
</td>
<td style="text-align:left;">
Some kids take little breaks when working on challenging homework. Would you say you are like them?
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl19
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl19
</td>
<td style="text-align:left;">
Some kids gather their notebooks or any materials they need before they start their homework. Would you say you are like them?
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl20
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl20
</td>
<td style="text-align:left;">
Some kids look for information in their notes, videos, books, internet or exercises when they are struggling with their homework. Would you say you are like them?
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl21
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl21
</td>
<td style="text-align:left;">
Some kids prepare for an exam by reviewing their notes or making study materials. Would you say you are like them?
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl24
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl24
</td>
<td style="text-align:left;">
Some kids look to see how hard their homework is before deciding whether they will work on their homework or do something fun. Would you say you are like them?
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
<tr>
<td style="text-align:left;">
csrl22
</td>
<td style="text-align:left;">
integer
</td>
<td style="text-align:left;">
csrl22
</td>
<td style="text-align:left;">
Some kids prepare for an exam by doing practice tests to see where they are having trouble. Would you say you are like them?
</td>
<td style="text-align:left;">
coding(code(““A lot like them”“, 3), code(”“Kind of like them”“, 2), code(”“A little like them”“, 1), code(”“Not at all like them”“, 0))
</td>
<td style="text-align:left;">
in_set(c(0:3, NA))
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
<td style="text-align:left;">
Child Self-Regulated Learning
</td>
</tr>
</tbody>
</table></div>
</div>
<p>These metadata CSVs have three required fields:</p>
<ul>
<li>
<strong>name</strong>: The variable name</li>
<li>
<strong>type</strong>: The variable type (usually “character”, “integer”, “double”, or “logical”)</li>
<li>
<strong>description</strong>: Description of the variable content. If the dataset corresponds to a survey, this is usually the question wording in English.</li>
</ul>
<p>There are often other columns:</p>
<ul>
<li>
<strong>coding</strong>: If the variable is categorical, this contains the label-value mapping for the variable, written with <a href="https://nyuglobalties.github.io/rcoder">rcoder</a> syntax.</li>
<li>
<strong>tests</strong>: Any content tests on the data</li>
<li>
<strong>scale</strong>: If the variable belongs to a psychometric scale, the name of the scale. This is used for identifying variable groups for psychometric descriptive statistics.</li>
<li>
<strong>title</strong>: A shorter description for the variable, used as a variable label when exported to Stata</li>
<li>
<strong>section</strong>: Codebook section; if no section is assigned, the codebook will place the variable into the “Other” section</li>
<li>
<strong>section_description</strong>: Description for the section. Useful for providing extra context for the codebook section.</li>
<li>
<strong>group</strong>: Codebook subsection / variable group. Useful to have for combining a collection of variables together e.g. a scale</li>
<li>
<strong>group_description</strong>: Description for the variable group. Useful for adding an introductory statement asked before each question in the group.</li>
</ul>
</div>
<div id="codebooks" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> <code>codebooks</code><a class="anchor" aria-label="anchor" href="#codebooks"><i class="fas fa-link"></i></a>
</h2>
<p>“Codebooks” are essentially <a href="https://en.wikipedia.org/wiki/Data_dictionary">data dictionaries</a>, targeted for social science research. They commonly include enumerations of variables in a dataset, as well as their descriptions and (when applicable) categorical codings. Some codebooks also include methodology descriptions and other descriptive statistics of the data.</p>
<p>The <code>codebooks</code> folder contains HTML codebook exports of selected blueprints, as indicated by the presence of <code>blueprintr::bp_export_codebook()</code> in the blueprint definition file:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">blueprint</span><span class="op">(</span>
  <span class="st">"ch_scales"</span>,
  description <span class="op">=</span> <span class="st">"Self-Regulation &amp; Self-Regulated Learning"</span>,
  command <span class="op">=</span>
    <span class="fu">some_command</span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span> |&gt;
  <span class="fu">bp_export_codebook</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Unless otherwise agreed upon, <strong>these codebooks are for internal purposes only</strong>. They are mainly present to support TIES’ members in their research.</p>
</div>
<div id="config" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> <code>config</code><a class="anchor" aria-label="anchor" href="#config"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>config</code> folder has two main R files:</p>
<ul>
<li><code>environment.R</code></li>
<li><code>packages.R</code></li>
</ul>
<p>Other project-specific files, like YAML configuration, may be stored in this folder.</p>
<div id="environment.r" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> <code>environment.R</code><a class="anchor" aria-label="anchor" href="#environment.r"><i class="fas fa-link"></i></a>
</h3>
<p>Sensitive information necessary for pipeline function, like API keys and passwords, <strong>must</strong> be stored as environment variables and <strong>never</strong> checked into version control. Environment variables are generally stored in a personal <a href="https://rstats.wtf/r-startup.html#renviron"><code>.Renviron</code></a> file, but it is our practice to load them into global variables at the start of the pipeline to avoid unnecessary calls to <code><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv()</a></code>.</p>
<p>Here is an example <code>environment.R</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">BOX_PATH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"BOX_PATH"</span>, unset <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="va">F_RUN_TESTS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html">as.logical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"F_RUN_TESTS"</span>, unset <span class="op">=</span> <span class="st">"FALSE"</span><span class="op">)</span><span class="op">)</span>
<span class="va">F_NIGHTLY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html">as.logical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"F_NIGHTLY"</span>, unset <span class="op">=</span> <span class="st">"FALSE"</span><span class="op">)</span><span class="op">)</span>

<span class="va">CACHE_PASSPHRASE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"CACHE_PASSPHRASE"</span>, unset <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
</div>
<div id="packages.r" class="section level3" number="4.3.2">
<h3>
<span class="header-section-number">4.3.2</span> <code>packages.R</code><a class="anchor" aria-label="anchor" href="#packages.r"><i class="fas fa-link"></i></a>
</h3>
<p>This file serves two purposes:</p>
<ol style="list-style-type: decimal">
<li>Capture soft dependencies in the project code (i.e. packages that are required but not directly referred to in the code)</li>
<li>Attach packages via <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> to make those packages’ exported functions available across the entire pipeline</li>
</ol>
<p>Our project structure uses <a href="https://rstudio.github.io/renv/articles/renv.html"><code>renv</code></a> to manage the specific versions of packages employed in our pipeline to improve replicability. <code>renv</code> is able to capture these dependencies via code inspection; however sometimes a soft dependency (one that is not explicitly stated in the code) can occur e.g. a package depends on another for some plotting routine. To capture these dependecies, we place a reference to one of the package’s functions in <code>packages.R</code> so that <code>renv</code> can treat that package as a hard dependency.</p>
<p>Use of <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> should be restricted to packages that are used extensively. As stated in <a href="styling-r.html#rstyle-funcs-package-deps">5.2.1</a>, it is preferred to use <code>package::func()</code> syntax in function writing; moreover, it is preferred the same style throughout most of the pipeline definition as well for clarity and long-term maintenance.</p>
<p>Example of <code>packages.R</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Retain suggested packages in renv</span>
<span class="fu">labelled</span><span class="fu">::</span><span class="va">to_labelled</span>
<span class="fu">kableExtra</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/kableExtra/man/kable_as_image.html">kable_as_image</a></span>
<span class="fu">styler</span><span class="fu">::</span><span class="va"><a href="https://styler.r-lib.org/reference/style_dir.html">style_dir</a></span> <span class="co"># Format-on-save capability in VSCode</span>
<span class="fu">languageserver</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/languageserver/man/run.html">run</a></span> <span class="co"># Necessary for VSCode to work in renv projects</span>

<span class="co"># Attach packages used in the entire pipeline here</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/">targets</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tarchetypes/">tarchetypes</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/markfairbanks/tidytable">tidytable</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">blueprintr</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rcoder</span><span class="op">)</span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="dt-workflow.html"><span class="header-section-number">3</span> How the Data Team schedules work</a></div>
<div class="next"><a href="styling-r.html"><span class="header-section-number">5</span> R Style Guide</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#dt-proj-structure"><span class="header-section-number">4</span> Project Structure</a></li>
<li><a class="nav-link" href="#blueprints"><span class="header-section-number">4.1</span> blueprints</a></li>
<li><a class="nav-link" href="#codebooks"><span class="header-section-number">4.2</span> codebooks</a></li>
<li>
<a class="nav-link" href="#config"><span class="header-section-number">4.3</span> config</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#environment.r"><span class="header-section-number">4.3.1</span> environment.R</a></li>
<li><a class="nav-link" href="#packages.r"><span class="header-section-number">4.3.2</span> packages.R</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/nyuglobalties/dt-handbook/blob/master/handbook/guides/projects.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/nyuglobalties/dt-handbook/edit/master/handbook/guides/projects.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Team Handbook</strong>" was written by Global TIES for Children Data Team. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
